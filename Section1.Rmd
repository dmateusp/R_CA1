---
title: "- Data Understanding and Data Exploration"
output: html_notebook
---
# EuroCom

### Dependencies
```{r}
#install.packages("ggplot2")
library(ggplot2)
```

## Reading the dataset

```{r}
phones <- read.csv("./eurocomPHONEchurners.csv")
head(phones)
```

## Data pre-processing

Getting how many null values there is per column.

```{r}
count_na <- sapply(phones, function(y) sum(length(which(is.na(y) | y == ""))))
na_df <- data.frame(count_na)

subset(na_df, na_df$count_na > 0)
```
### Replacing na numerics with medians
```{r}
replace_na_with_median <- function(col) {
  median_without_na <- median(col, na.rm=TRUE)
  col[is.na(col)] <- median_without_na
  return(col)
}
```
### MINUTES_3MONTHS_AGO
```{r}
phones$MINUTES_3MONTHS_AGO <- replace_na_with_median(phones$MINUTES_3MONTHS_AGO)
```
### CUST_MOS
```{r}
phones$CUST_MOS <- replace_na_with_median(phones$CUST_MOS)
```
### TOT_MINUTES_USAGE
```{r}
phones$TOT_MINUTES_USAGE <- replace_na_with_median(phones$TOT_MINUTES_USAGE)
```


### Getting the mode for categorical columns
```{r}
get_mode <- function(x){
  xtable <- table(x)
  idx <- xtable == max(xtable)
  names(xtable)[idx]
}
```
### PHONE_PLAN
```{r}
phones$PHONE_PLAN[phones$PHONE_PLAN == ""] <- get_mode(phones$PHONE_PLAN)
```
### EDUCATION
```{r}
phones$EDUCATION[phones$EDUCATION == ""] <- get_mode(phones$EDUCATION)
```


### Discretising Income predictor values
```{r}
head(phones$INCOME)
```

```{r}
phones$INCOME <- cut(phones$INCOME, breaks = c(0, 38000, 88000, max(phones$INCOME)), include.lowest = TRUE, labels = c("Low Income", "Medium Income","High Income"))

head(phones$INCOME)
```

### Studying the distribution of the numeric attributes

### CUST_MOS
```{r}
ggplot(data=phones ,aes(phones$CUST_MOS)) + geom_histogram(binwidth=5) + scale_x_continuous(breaks = seq(0,60,5))
```
### NUM_LINES
```{r}
ggplot(data=phones ,aes(phones$NUM_LINES)) + geom_histogram(binwidth=1) + scale_x_continuous(breaks = 0:3)
```
### TOT_MINUTES_USAGE
```{r}
ggplot(data=phones ,aes(phones$TOT_MINUTES_USAGE)) + geom_histogram(bins = 30) +  scale_x_continuous(breaks = seq(0, 30000, 3000))
```
### INCOME
```{r}
ggplot(data=phones ,aes(phones$INCOME)) + geom_histogram(stat="count")
```
### PHONE_PLAN
```{r}
ggplot(data=phones ,aes(phones$PHONE_PLAN)) + geom_histogram(stat="count")
```
### EDUCATION
```{r}
ggplot(data=phones ,aes(phones$EDUCATION)) + geom_histogram(stat="count")
```
### Seeing the influence on churn
### INCOME
```{r}
ggplot(data=phones ,aes(x=phones$INCOME, group=phones$CHURNER, fill=phones$CHURNER)) + geom_histogram(stat="count") + theme_bw()
```
### PHONE_PLAN
```{r}
ggplot(data=phones ,aes(x=phones$PHONE_PLAN, group=phones$CHURNER, fill=phones$CHURNER)) + geom_histogram(stat="count") + theme_bw()
```

### TOT_MINUTES_USAGE
```{r}
ggplot(data=phones ,aes(x=phones$TOT_MINUTES_USAGE, group=phones$CHURNER, fill=phones$CHURNER)) + geom_histogram(bins = 5) +  scale_x_continuous(breaks = seq(0, 30000, 5000))
```

### CUST_MOS
```{r}
ggplot(data=phones ,aes(x=phones$CUST_MOS, group=phones$CHURNER, fill=phones$CHURNER)) + geom_histogram(binwidth=5) + scale_x_continuous(breaks = seq(0,50,5))
```
### NUM_LINES
```{r}
ggplot(data=phones ,aes(x=phones$NUM_LINES, group=phones$CHURNER, fill=phones$CHURNER)) + geom_histogram(binwidth=1, position="dodge") + scale_x_continuous(breaks = 0:3)
```
### EDUCATION
```{r}
ggplot(data=phones ,aes(x=phones$EDUCATION, group=phones$CHURNER, fill=phones$CHURNER)) + geom_histogram(stat="count")
```
### GENDER
```{r}
ggplot(data=phones ,aes(x=phones$GENDER, group=phones$CHURNER, fill=phones$CHURNER)) + geom_histogram(stat="count", position="dodge")
```